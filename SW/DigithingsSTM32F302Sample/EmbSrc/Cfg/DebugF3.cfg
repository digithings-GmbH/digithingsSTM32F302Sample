
adapter driver st-link
st-link vid_pid 0x0483 0x3744 0x0483 0x3748 0x0483 0x374b 0x0483 0x374d 0x0483 0x374e 0x0483 0x374f 0x0483 0x3752 0x0483 0x3753
transport select dapdirect_swd

proc swj_newdap {chip tag args} {
     eval swd newdap $chip $tag $args
}

swj_newdap mychip cpu -expected-id 0x6ba02477
dap create mychip.dap -chain-position mychip.cpu
target create MyTarget cortex_m -endian little -dap mychip.dap -ap-num 0

cortex_m reset_config sysresetreq
adapter speed 200

MyTarget configure -work-area-phys 0x20000000 -work-area-size 10000 -work-area-backup 0
flash bank myChip.flash stm32f1x 0x08000000 0 0 0 MyTarget